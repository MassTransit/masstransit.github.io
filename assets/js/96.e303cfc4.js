(window.webpackJsonp=window.webpackJsonp||[]).push([[96],{515:function(t,s,e){"use strict";e.r(s);var a=e(34),n=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"_7-1-8"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_7-1-8"}},[t._v("#")]),t._v(" 7.1.8")]),t._v(" "),e("p"),e("div",{staticClass:"table-of-contents"},[e("ul",[e("li",[e("a",{attrs:{href:"#resolved-issues"}},[t._v("Resolved Issues")])]),e("li",[e("a",{attrs:{href:"#masstransit-templates-getting-started"}},[t._v("MassTransit Templates, Getting Started")])]),e("li",[e("a",{attrs:{href:"#delayed-message-delivery-redelivery"}},[t._v("Delayed Message Delivery / Redelivery")])]),e("li",[e("a",{attrs:{href:"#exceptioninfo-data"}},[t._v("ExceptionInfo Data")])]),e("li",[e("a",{attrs:{href:"#raw-json-message-headers"}},[t._v("Raw JSON Message Headers")])]),e("li",[e("a",{attrs:{href:"#state-machine-delay-provider"}},[t._v("State Machine Delay Provider")])]),e("li",[e("a",{attrs:{href:"#azure-blob-storage-package-change"}},[t._v("Azure Blob Storage Package Change")])])])]),e("p"),t._v(" "),e("h2",{attrs:{id:"resolved-issues"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#resolved-issues"}},[t._v("#")]),t._v(" Resolved Issues")]),t._v(" "),e("ul",[e("li",[t._v("Responding from a state machine through the InMemoryOutbox "),e("a",{attrs:{href:"https://github.com/MassTransit/MassTransit/issues/2396",target:"_blank",rel:"noopener noreferrer"}},[t._v("wasn't working as expected"),e("OutboundLink")],1)]),t._v(" "),e("li",[t._v("Kafka producer options can now be configured")]),t._v(" "),e("li",[e("code",[t._v("IsResponseAccepted")]),t._v(" will now return "),e("em",[t._v("false")]),t._v(" if a "),e("em",[t._v("ResponseAddress")]),t._v(" is not present")]),t._v(" "),e("li",[t._v("Azure Service Bus receive endpoints should now allow "),e("code",[t._v("PrefetchCount = 0")])]),t._v(" "),e("li",[t._v("RabbitMQ Quorum queues can now be configured using "),e("code",[t._v(".SetQuorumQueue()")]),t._v(", which sets the appropriate queue attributes")]),t._v(" "),e("li",[t._v("RabbitMQ queue attributes are now copied to the "),e("code",[t._v("_error")]),t._v(" and "),e("code",[t._v("_skipped")]),t._v(" queues")])]),t._v(" "),e("h2",{attrs:{id:"masstransit-templates-getting-started"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#masstransit-templates-getting-started"}},[t._v("#")]),t._v(" MassTransit Templates, Getting Started")]),t._v(" "),e("p",[t._v("A set of "),e("code",[t._v("dotnet new")]),t._v(" templates were released, which can be installed using "),e("code",[t._v("dotnet new -i MassTransit.Templates")]),t._v(". The "),e("a",{attrs:{href:"/getting-started"}},[t._v("Getting Started")]),t._v(" documentation was updated to use the new templates and a new "),e("a",{attrs:{href:"https://github.com/MassTransit/Sample-GettingStarted",target:"_blank",rel:"noopener noreferrer"}},[t._v("sample was added"),e("OutboundLink")],1),t._v(" based on the documentation. Most of the new documentation will be written from a container-first perspective, starting with "),e("em",[t._v("AddMassTransit")]),t._v(" and subsequently documenting the container-free versions where available.")]),t._v(" "),e("h2",{attrs:{id:"delayed-message-delivery-redelivery"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#delayed-message-delivery-redelivery"}},[t._v("#")]),t._v(" Delayed Message Delivery / Redelivery")]),t._v(" "),e("p",[t._v("It is now possible to configure "),e("em",[t._v("delayed")]),t._v(" redelivery using the message transport. This approach works directly with the message transport, and does not use any configured message scheduler. A message scheduler can still be configured and used for regular message scheduling, but the transport message delay feature will be used for redelivery. This can significantly reduce the load on Quartz/Hangfire scheduling and separates the concerns of message redelivery and message scheduling.")]),t._v(" "),e("p",[t._v("The configuration syntax is the same as scheduled redelivery, but with a new transport-independent extension method:")]),t._v(" "),e("div",{staticClass:"language-cs extra-class"},[e("pre",{pre:!0,attrs:{class:"language-cs"}},[e("code",[t._v("cfg"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("ReceiveEndpoint")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"submit-order"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" e "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    e"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("UseDelayedRedelivery")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("r "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" r"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("Intervals")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("TimeSpan"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("FromMinutes")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" TimeSpan"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("FromMinutes")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" TimeSpan"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("FromMinutes")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    e"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("UseMessageRetry")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("r "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" r"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("Immediate")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    e"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("UseInMemoryOutbox")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    e"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token generic-method"}},[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("ConfigureConsumer")]),e("span",{pre:!0,attrs:{class:"token generic class-name"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("SubmitOrder"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("blockquote",[e("p",[t._v("The in-memory transport was updated to support delayed message delivery, making it easier to test delayed message scenarios.")])]),t._v(" "),e("p",[t._v("The new delayed support can also be used a message scheduler, regardless of transport. To configure the delayed exchange scheduler, see the example below.")]),t._v(" "),e("div",{staticClass:"language-cs extra-class"},[e("pre",{pre:!0,attrs:{class:"language-cs"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("namespace")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("SchedulingDelayed")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("System")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("MassTransit")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("Microsoft"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Extensions"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DependencyInjection")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Program")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token return-type class-name"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("Main")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token class-name"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")])]),t._v(" services "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token constructor-invocation class-name"}},[t._v("ServiceCollection")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n            services"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("AddMassTransit")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                x"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("AddDelayedMessageScheduler")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n                x"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("UsingInMemory")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("context"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cfg"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" \n                "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    cfg"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("UseDelayedMessageScheduler")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n                    cfg"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("ConfigureEndpoints")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("context"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])])])]),e("h2",{attrs:{id:"exceptioninfo-data"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#exceptioninfo-data"}},[t._v("#")]),t._v(" ExceptionInfo Data")]),t._v(" "),e("p",[t._v("The "),e("code",[t._v("ExceptionInfo")]),t._v(" type has a new property, "),e("code",[t._v("Data")]),t._v(", which is a "),e("code",[t._v("IDictionary<string, object>")]),t._v(". This extra property supports the inclusion of application/exception specific data with the exception details. Since MassTransit does not support the directly serialization of "),e("code",[t._v("Exception")]),t._v(" types (nor should it), this makes it possible to include additional values when an exception is thrown.")]),t._v(" "),e("p",[t._v("This is an opt-in approach, and by default no exception data will be added. "),e("strong",[t._v("This was decided to avoid accidental leakage of sensitive data.")])]),t._v(" "),e("p",[t._v("A new exception type, "),e("code",[t._v("MassTransitApplicationException")]),t._v(", can be used to opt-in to the automatic propagation of Data properties into "),e("code",[t._v("ExceptionInfo.Data")]),t._v(". For example, data values can be explicitly added when the exception is caught and thrown.")]),t._v(" "),e("div",{staticClass:"language-cs extra-class"},[e("pre",{pre:!0,attrs:{class:"language-cs"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SubmitOrderConsumer")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token type-list"}},[e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IConsumer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("SubmitOrder"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token return-type class-name"}},[t._v("Task")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("Consume")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ConsumeContext"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("SubmitOrder"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" context"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token constructor-invocation class-name"}},[t._v("IntentionalTestException")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"This was intentional"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Exception")]),t._v(" exception"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token constructor-invocation class-name"}},[t._v("MassTransitApplicationException")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("exception"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                context"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Message"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OrderNumber"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                context"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Message"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CustomerNumber"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("The built-in "),e("code",[t._v("Data")]),t._v(" property of "),e("code",[t._v("Exception")]),t._v(" will also be used as a source when using "),e("code",[t._v("MassTransitApplicationException")]),t._v(". In the example below, the "),e("code",[t._v("Data")]),t._v("properties are added to the exception (framework and other libraries use this to store information, this example just does it to show the usage).")]),t._v(" "),e("div",{staticClass:"language-cs extra-class"},[e("pre",{pre:!0,attrs:{class:"language-cs"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SubmitOrderConsumer")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token type-list"}},[e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IConsumer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("SubmitOrder"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token return-type class-name"}},[t._v("Task")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("Consume")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ConsumeContext"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("SubmitOrder"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" context"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token class-name"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")])]),t._v(" exception "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token constructor-invocation class-name"}},[t._v("IntentionalTestException")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"This was intentional"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                exception"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Data"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("Add")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Username"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Frank"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                exception"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Data"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("Add")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"CustomerId"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("27")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" exception"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Exception")]),t._v(" exception"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token constructor-invocation class-name"}},[t._v("MassTransitApplicationException")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("exception"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("h2",{attrs:{id:"raw-json-message-headers"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#raw-json-message-headers"}},[t._v("#")]),t._v(" Raw JSON Message Headers")]),t._v(" "),e("p",[t._v("The Raw JSON message serializer/deserializer was updated to support transport message headers, offering better support for messages without a regular MassTransit message envelope. The supported message headers include:")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("Name")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Type")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Property")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Notes")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("MessageId")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("Guid")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("MessageId")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}})]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("CorrelationId")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("Guid")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("CorrelationId")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}})]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("ConverationId")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("Guid")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("ConversationId")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}})]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("RequestId")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("Guid")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("RequestId")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}})]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("MT-InitiatorId")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("Guid")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("InitiatorId")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}})]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("MT-Source-Address")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("Uri")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("SourceAddress")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}})]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("MT-Response-Address")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("Uri")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("ResponseAddress")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}})]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("MT-Fault-Address")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("Uri")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("FaultAddress")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}})]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("MT-MessageType")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("string")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("SupportedMessageTypes")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v(";")]),t._v("delimited")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("MT-Host-Info")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("JSON")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("Host")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("serialized "),e("code",[t._v("Host")])])])])]),t._v(" "),e("p",[t._v("The default configuration doesn't change the existing behavior. When configuring the use of the Raw JSON serializer, new options are available:")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("Option")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Description")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("AnyMessageType")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Default behavior, any "),e("code",[t._v("T")]),t._v(" is allowed. Do not specify to check the transport message type header")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("AddTransportHeaders")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Default behavior, headers are written to the transport and used")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("CopyHeaders")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Optional, will copy non-MassTransit headers to outbound messages")])])])]),t._v(" "),e("p",[t._v("These options are specified as a parameter to "),e("code",[t._v("cfg.UseRawJsonSerializer(options)")]),t._v(".")]),t._v(" "),e("h2",{attrs:{id:"state-machine-delay-provider"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#state-machine-delay-provider"}},[t._v("#")]),t._v(" State Machine Delay Provider")]),t._v(" "),e("p",[t._v("When configuring a message schedule in an Automatonymous state machine, instead of specifying a fixed delay, a "),e("code",[t._v("DelayProvider")]),t._v(" can be configured. This enables dynamic delay periods based upon the contents of the state machine instance. The delay can still be dynamically specified when using "),e("code",[t._v(".Schedule()")]),t._v(" based upon the instance and/or message contents.")]),t._v(" "),e("h2",{attrs:{id:"azure-blob-storage-package-change"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#azure-blob-storage-package-change"}},[t._v("#")]),t._v(" Azure Blob Storage Package Change")]),t._v(" "),e("p",[t._v("The Azure Blob Storage Message Data repository was changed to use the new standard Azure packages. This may require slight reconfiguration, but should work as it did previously.")])])}),[],!1,null,null,null);s.default=n.exports}}]);